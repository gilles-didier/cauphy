<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Posterior density of an increment — increment • cauphy</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Posterior density of an increment — increment"><meta property="og:description" content="Compute the posterior density of a branch increment under a fitted Cauchy process on a phylogenetic tree."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cauphy</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/lizards.html">Example Analysis</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/gilles-didier/cauphy/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Posterior density of an increment</h1>
    <small class="dont-index">Source: <a href="https://github.com/gilles-didier/cauphy/blob/v1.0.3/R/densities.R" class="external-link"><code>R/densities.R</code></a></small>
    <div class="hidden name"><code>increment.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute the posterior density of a branch increment under a fitted Cauchy process on a phylogenetic tree.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">increment</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'cauphylm'</span></span>
<span><span class="fu">increment</span><span class="op">(</span><span class="va">x</span>, <span class="va">node</span>, <span class="va">values</span>, n_values <span class="op">=</span> <span class="fl">100</span>, n_cores <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'cauphyfit'</span></span>
<span><span class="fu">increment</span><span class="op">(</span><span class="va">x</span>, <span class="va">node</span>, <span class="va">values</span>, n_values <span class="op">=</span> <span class="fl">100</span>, n_cores <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>an object of class <code><a href="fitCauchy.html">fitCauchy</a></code> or <code><a href="cauphylm.html">cauphylm</a></code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>other arguments to be passed to the method.</p></dd>


<dt id="arg-node">node<a class="anchor" aria-label="anchor" href="#arg-node"></a></dt>
<dd><p>vector of nodes ending the branches for which to compute the posterior density of the increment. If not specified, the reconstruction is done on all the possible edges.</p></dd>


<dt id="arg-values">values<a class="anchor" aria-label="anchor" href="#arg-values"></a></dt>
<dd><p>the vector of values where the density should be computed. If not specified, the reconstruction is done for a grid of <code>n_values</code> values between <code>-1.5 * maxdiff</code> and <code>1.5 * maxdiff</code>, where <code>maxdiff</code> is the difference between the larger and smaller tip value.</p></dd>


<dt id="arg-n-values">n_values<a class="anchor" aria-label="anchor" href="#arg-n-values"></a></dt>
<dd><p>the number of point for the grid of values. Default to <code>100</code>. Ignored if <code>values</code> is provided.</p></dd>


<dt id="arg-n-cores">n_cores<a class="anchor" aria-label="anchor" href="#arg-n-cores"></a></dt>
<dd><p>number of cores for the parallelization. Default to 1.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>an object of S3 class <code>ancestralCauchy</code>,
 which is a matrix of posterior increment values, with nodes in rows and values in columns.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function assumes a Cauchy Process on the tree with fitted parameters
(see <code><a href="fitCauchy.html">fitCauchy</a></code>),
and computes the posterior ancestral density of trait increments at branches
(ie, the difference between the traits value at the end and beginning of the branch),
conditionally on the vector of tip values.</p>
<p>It computes the posterior density on all the points in <code>values</code>,
that should be refined enough to get a good idea of the density curve.</p>
    </div>
    <div id="methods-by-class-">
    <h2>Methods (by class)</h2>

<ul><li><p><code>increment(cauphylm)</code>: <code><a href="cauphylm.html">cauphylm</a></code> object</p></li>
<li><p><code>increment(cauphyfit)</code>: <code><a href="fitCauchy.html">fitCauchy</a></code> object</p></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    <p>Bastide, P. and Didier, G. 2023. The Cauchy Process on Phylogenies: a Tractable Model for Pulsed Evolution. Systematic Biology. doi:10.1093/sysbio/syad053.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="fitCauchy.html">fitCauchy</a></code>, <code><a href="cauphylm.html">cauphylm</a></code>,
<code><a href="plot.ancestralCauchy.html">plot.ancestralCauchy</a></code>, <code><a href="plot_asr.html">plot_asr</a></code>, <code><a href="ancestral.html">ancestral</a></code>,
<code><a href="hdi.ancestralCauchy.html">hdi.ancestralCauchy</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1289</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Simulate tree and data</span></span></span>
<span class="r-in"><span><span class="va">phy</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rlineage.html" class="external-link">rphylo</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">0.1</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="rTraitCauchy.html">rTraitCauchy</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, phy <span class="op">=</span> <span class="va">phy</span>, model <span class="op">=</span> <span class="st">"cauchy"</span>,</span></span>
<span class="r-in"><span>                    parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>root.value <span class="op">=</span> <span class="fl">10</span>, disp <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Fit the data</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="fitCauchy.html">fitCauchy</a></span><span class="op">(</span><span class="va">phy</span>, <span class="va">dat</span>, model <span class="op">=</span> <span class="st">"cauchy"</span>, method <span class="op">=</span> <span class="st">"reml"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Reconstruct the ancestral increments</span></span></span>
<span class="r-in"><span><span class="va">inc</span> <span class="op">&lt;-</span> <span class="fu">increment</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_asr.html">plot_asr</a></span><span class="op">(</span><span class="va">fit</span>, inc <span class="op">=</span> <span class="va">inc</span>, offset <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="increment-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">inc</span>, node <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">8</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="increment-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Refine grid for edges ending at tips 3 and 8</span></span></span>
<span class="r-in"><span><span class="va">inc2</span> <span class="op">&lt;-</span> <span class="fu">increment</span><span class="op">(</span><span class="va">fit</span>, node <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">8</span><span class="op">)</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">inc2</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="increment-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Find HDI</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">HDInterval</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hdi_inc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/HDInterval/man/hdi.html" class="external-link">hdi</a></span><span class="op">(</span><span class="va">inc2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hdi_inc</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`3`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      begin  end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -1.85 0.59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"credMass")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"height")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.07962038</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`8`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      begin  end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.51 1.92</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"credMass")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"height")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0802933</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">inc2</span>, interval <span class="op">=</span> <span class="va">hdi_inc</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="increment-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Gilles Didier, Paul Bastide.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

